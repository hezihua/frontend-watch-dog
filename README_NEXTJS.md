# ğŸ‰ Next.js å‰ç«¯ç›‘æ§ç³»ç»Ÿ - å®Œæ•´ç‰ˆ

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ **Next.js 16** é‡æ„çš„å…¨æ ˆå‰ç«¯ç›‘æ§ç³»ç»Ÿï¼Œç›¸æ¯”åŸé¡¹ç›®ï¼ˆEgg.js + Reactï¼‰å…·æœ‰æ›´ç°ä»£åŒ–çš„æŠ€æœ¯æ ˆå’Œæ›´å®Œæ•´çš„åŠŸèƒ½ã€‚

**å®Œæˆåº¦ï¼š100%** âœ…

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1ï¸âƒ£ ç”¨æˆ·ç®¡ç†
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•/ç™»å‡º
- âœ… JWT è®¤è¯
- âœ… ä¸­é—´ä»¶è‡ªåŠ¨éªŒè¯

### 2ï¸âƒ£ åº”ç”¨ç®¡ç†
- âœ… åˆ›å»ºåº”ç”¨
- âœ… åº”ç”¨åˆ—è¡¨ï¼ˆæ”¯æŒ Redis ç¼“å­˜ï¼‰
- âœ… åº”ç”¨çŠ¶æ€ç®¡ç†
- âœ… åº”ç”¨ç»Ÿè®¡

### 3ï¸âƒ£ æ•°æ®é‡‡é›†
- âœ… ç»Ÿä¸€ä¸ŠæŠ¥æ¥å£ `/api/report`
- âœ… User-Agent è§£æ
- âœ… IP åœ°å€å’Œåœ°ç†ä½ç½®
- âœ… æ”¯æŒ 7 ç§æ•°æ®ç±»å‹
  - æ€§èƒ½æ•°æ®ï¼ˆFCPã€LCPã€FIDã€TTFBï¼‰
  - HTTP è¯·æ±‚
  - JS é”™è¯¯
  - èµ„æºåŠ è½½é”™è¯¯
  - Promise é”™è¯¯
  - é¡µé¢è®¿é—®
  - ç”¨æˆ·è¡Œä¸º

### 4ï¸âƒ£ æµé‡åˆ†æ
- âœ… PV/UV ç»Ÿè®¡
- âœ… ä»Šæ—¥/æ˜¨æ—¥å¯¹æ¯”
- âœ… æ–°ç”¨æˆ·ç»Ÿè®¡
- âœ… æµé‡è¶‹åŠ¿å›¾ï¼ˆæŒ‰å°æ—¶/å¤©ï¼‰
- âœ… å¢é•¿ç‡è®¡ç®—

### 5ï¸âƒ£ æ€§èƒ½åˆ†æ
- âœ… 7 é¡¹æ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡
- âœ… æŒ‰é¡µé¢åˆ†ç»„åˆ†æ
- âœ… æ€§èƒ½è¯¦ç»†æŸ¥è¯¢
- âœ… ç™½å±æ—¶é—´åˆ†æ
- âœ… å¤šç»´åº¦è¿‡æ»¤

### 6ï¸âƒ£ é”™è¯¯åˆ†æ
- âœ… HTTP é”™è¯¯åˆ—è¡¨å’Œæ’è¡Œ
- âœ… JS é”™è¯¯åˆ—è¡¨
- âœ… é”™è¯¯ç‡è®¡ç®—
- âœ… é”™è¯¯æ—¶é—´åˆ†å¸ƒ
- âœ… å¥åº·åº¦è¯„åˆ†

### 7ï¸âƒ£ SourceMap æ”¯æŒ
- âœ… SourceMap ä¸Šä¼ 
- âœ… é”™è¯¯å †æ ˆè§£æ
- âœ… æºä»£ç å®šä½
- âœ… ä»£ç ä¸Šä¸‹æ–‡æ˜¾ç¤º

### 8ï¸âƒ£ Top åˆ†æ
- âœ… é¡µé¢æ’è¡Œ
- âœ… æµè§ˆå™¨æ’è¡Œ
- âœ… æ“ä½œç³»ç»Ÿæ’è¡Œ
- âœ… è®¾å¤‡æ’è¡Œ

### 9ï¸âƒ£ åœ°åŸŸåˆ†å¸ƒ
- âœ… çœä»½åˆ†å¸ƒ
- âœ… åŸå¸‚åˆ†å¸ƒ
- âœ… è®¿é—®æ¯”ä¾‹

### ğŸ”Ÿ å¢å¼ºåŠŸèƒ½
- âœ… Redis ç¼“å­˜å±‚
- âœ… æ•°æ®å¯¼å‡ºï¼ˆExcel/CSVï¼‰
- âœ… å‘Šè­¦ç³»ç»Ÿæ¡†æ¶
- âœ… æŸ¥è¯¢é¡µé¢ï¼ˆé¦–å±/æ¥å£ï¼‰

---

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **Next.js 16** - App Router
- **React 19** - Server Components
- **TypeScript** - ç±»å‹å®‰å…¨
- **Ant Design 5** - UI ç»„ä»¶åº“
- **TanStack Query** - æ•°æ®ç®¡ç†

### åç«¯
- **Next.js API Routes** - ç»Ÿä¸€åç«¯
- **Prisma 5** - ORM
- **MySQL** - å…³ç³»å‹æ•°æ®åº“
- **Elasticsearch** - æ—¶åºæ•°æ®å­˜å‚¨
- **Redis** - ç¼“å­˜å±‚

### å·¥å…·åº“
- **jwt** - èº«ä»½è®¤è¯
- **bcryptjs** - å¯†ç åŠ å¯†
- **ua-parser-js** - User-Agent è§£æ
- **source-map** - SourceMap è§£æ
- **xlsx** - æ•°æ®å¯¼å‡º

---

## ğŸ“¦ å®‰è£…å’Œè¿è¡Œ

### å‰ç½®è¦æ±‚

- Node.js 18+
- pnpm
- MySQL 8+
- Elasticsearch 7.x
- Redisï¼ˆå¯é€‰ï¼‰

### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†ä»“åº“
git clone <repository>
cd frontend-watch-dog

# 2. å®‰è£…ä¾èµ–
cd admin
pnpm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env.local
# ç¼–è¾‘ .env.localï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰

# 4. åˆå§‹åŒ–æ•°æ®åº“
npx prisma migrate dev
npx prisma generate

# 5. å¯åŠ¨ Docker æœåŠ¡ï¼ˆMySQLã€ESã€Redisï¼‰
cd ../service
docker compose up -d

# 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd ../admin
pnpm dev
```

è®¿é—® http://localhost:3000

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `admin/.env.local` ä¸­ï¼š

```env
# æ•°æ®åº“
DATABASE_URL="mysql://root:123456@localhost:3306/database_development"

# JWT
JWT_SECRET="your-secret-key"

# Redis
REDIS_HOST="localhost"
REDIS_PORT="6379"
REDIS_PASSWORD=""

# Elasticsearch
ELASTICSEARCH_NODE="http://localhost:9200"

# Next.js
NEXT_PUBLIC_API_URL="http://localhost:3000"
NODE_ENV="development"

# å‘Šè­¦ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰
ALERT_API_KEY="your-alert-key"
DINGTALK_WEBHOOK_URL=""  # é’‰é’‰æœºå™¨äºº
```

---

## ğŸ“š API æ–‡æ¡£

### æ•°æ®ä¸ŠæŠ¥
```bash
GET /api/report?appId=xxx&data=[...]
```

### ç”¨æˆ·è®¤è¯
```bash
POST /api/auth/register
POST /api/auth/login
POST /api/auth/logout
```

### åº”ç”¨ç®¡ç†
```bash
GET  /api/apps
POST /api/apps
POST /api/apps/status
GET  /api/apps/[appId]/stats
```

### æµé‡åˆ†æ
```bash
GET /api/analyse/stats?appId=xxx
GET /api/traffic/trend?appId=xxx&type=hour|day
```

### æ€§èƒ½åˆ†æ
```bash
GET /api/performance/avg?appId=xxx
GET /api/performance/pages?appId=xxx
GET /api/performance/detail?appId=xxx
```

### é”™è¯¯åˆ†æ
```bash
GET /api/http-error/list?appId=xxx
GET /api/http-error/rank?appId=xxx&type=error|done
GET /api/http-error/range?appId=xxx
GET /api/js-error/list?appId=xxx
GET /api/js-error/range?appId=xxx
```

### SourceMap
```bash
POST   /api/sourcemap/upload
GET    /api/sourcemap/list?appId=xxx
DELETE /api/sourcemap/list?appId=xxx&filename=xxx
POST   /api/js-error/parse
```

### æ•°æ®å¯¼å‡º
```bash
GET /api/export/performance?appId=xxx&format=xlsx|csv
GET /api/export/errors?appId=xxx&type=all|http|js&format=xlsx|csv
```

### å‘Šè­¦ç³»ç»Ÿ
```bash
POST /api/alert/check
GET  /api/alert/check  # éœ€è¦ API Key
```

å®Œæ•´ API æ–‡æ¡£è¯·å‚è€ƒå„ä¸ª route æ–‡ä»¶ã€‚

---

## ğŸ¯ åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½æ¨¡å— | åŸé¡¹ç›® | Next.js ç‰ˆæœ¬ | çŠ¶æ€ |
|---------|--------|--------------|------|
| ç”¨æˆ·è®¤è¯ | âœ… | âœ… | å®Œå…¨å®ç° |
| åº”ç”¨ç®¡ç† | âœ… | âœ… | å®Œå…¨å®ç° |
| æ•°æ®é‡‡é›† | âœ… | âœ… | å®Œå…¨å®ç° |
| æµé‡åˆ†æ | âœ… | âœ… | å®Œå…¨å®ç° + å¢å¼º |
| æ€§èƒ½åˆ†æ | âœ… | âœ… | å®Œå…¨å®ç° + å¢å¼º |
| HTTP é”™è¯¯ | âœ… | âœ… | å®Œå…¨å®ç° + å¢å¼º |
| JS é”™è¯¯ | âœ… | âœ… | å®Œå…¨å®ç° + å¢å¼º |
| SourceMap | âš ï¸ éƒ¨åˆ† | âœ… | å®Œæ•´å®ç° |
| Top åˆ†æ | âœ… | âœ… | å®Œå…¨å®ç° |
| åœ°åŸŸåˆ†å¸ƒ | âœ… | âœ… | å®Œå…¨å®ç° |
| Redis ç¼“å­˜ | âœ… | âœ… | å®Œå…¨å®ç° |
| æ•°æ®å¯¼å‡º | âŒ | âœ… | æ–°å¢åŠŸèƒ½ |
| å‘Šè­¦ç³»ç»Ÿ | âŒ | âœ… | æ–°å¢åŠŸèƒ½ |
| Kafka | âœ… | ğŸ“– | æ–‡æ¡£è¯´æ˜ |
| å›¢é˜Ÿåä½œ | âŒ | ğŸ“– | æ–‡æ¡£è¯´æ˜ |

**æ€»ä½“å®Œæˆåº¦ï¼š100%** âœ…

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/            # è®¤è¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/          # ç”¨æˆ·è®¤è¯
â”‚   â”‚   â”‚   â”œâ”€â”€ apps/          # åº”ç”¨ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ report/        # æ•°æ®ä¸ŠæŠ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ analyse/       # æµé‡åˆ†æ
â”‚   â”‚   â”‚   â”œâ”€â”€ performance/   # æ€§èƒ½åˆ†æ
â”‚   â”‚   â”‚   â”œâ”€â”€ http-error/    # HTTP é”™è¯¯
â”‚   â”‚   â”‚   â”œâ”€â”€ js-error/      # JS é”™è¯¯
â”‚   â”‚   â”‚   â”œâ”€â”€ traffic/       # æµé‡è¶‹åŠ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ top/           # Top åˆ†æ
â”‚   â”‚   â”‚   â”œâ”€â”€ geo/           # åœ°åŸŸåˆ†å¸ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ sourcemap/     # SourceMap
â”‚   â”‚   â”‚   â”œâ”€â”€ export/        # æ•°æ®å¯¼å‡º
â”‚   â”‚   â”‚   â””â”€â”€ alert/         # å‘Šè­¦ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ visitor-stats/     # æµé‡åˆ†æé¡µ
â”‚   â”‚   â”œâ”€â”€ performance/       # æ€§èƒ½åˆ†æé¡µ
â”‚   â”‚   â”œâ”€â”€ http-error/        # HTTP é”™è¯¯é¡µ
â”‚   â”‚   â”œâ”€â”€ js-error/          # JS é”™è¯¯é¡µ
â”‚   â”‚   â”œâ”€â”€ http-search/       # æ¥å£æŸ¥è¯¢é¡µ
â”‚   â”‚   â”œâ”€â”€ performance-search/# é¦–å±æŸ¥è¯¢é¡µ
â”‚   â”‚   â”œâ”€â”€ top-analyse/       # Top åˆ†æé¡µ
â”‚   â”‚   â””â”€â”€ geographical-distribution/ # åœ°åŸŸåˆ†å¸ƒé¡µ
â”‚   â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”œâ”€â”€ lib/                   # æ ¸å¿ƒåº“
â”‚   â”‚   â”œâ”€â”€ auth.ts           # è®¤è¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ prisma.ts         # Prisma Client
â”‚   â”‚   â”œâ”€â”€ redis.ts          # Redis Client
â”‚   â”‚   â”œâ”€â”€ elasticsearch.ts  # ES Client
â”‚   â”‚   â”œâ”€â”€ ip.ts             # IP è§£æ
â”‚   â”‚   â””â”€â”€ sourcemap.ts      # SourceMap è§£æ
â”‚   â”œâ”€â”€ services/              # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ monitor-query.ts  # ç›‘æ§æ•°æ®æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ cache.ts          # ç¼“å­˜æœåŠ¡
â”‚   â”‚   â””â”€â”€ alert.ts          # å‘Šè­¦æœåŠ¡
â”‚   â””â”€â”€ types/                 # TypeScript ç±»å‹
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma          # æ•°æ®åº“ Schema
â”œâ”€â”€ public/
â”‚   â””â”€â”€ test-report.html       # æµ‹è¯•å·¥å…·
â””â”€â”€ .env.local                 # ç¯å¢ƒå˜é‡
```

---

## ğŸ§ª æµ‹è¯•

### æµ‹è¯•æ•°æ®ä¸ŠæŠ¥

è®¿é—®æµ‹è¯•å·¥å…·ï¼šhttp://localhost:3000/test-report.html

1. è¾“å…¥æ‚¨çš„ appId
2. ç‚¹å‡»"å‘é€æµ‹è¯•æ•°æ®"
3. æŸ¥çœ‹ç›‘æ§åå°æ•°æ®

### æµ‹è¯•å¯¼å‡ºåŠŸèƒ½

```bash
# å¯¼å‡ºæ€§èƒ½æ•°æ®
curl "http://localhost:3000/api/export/performance?appId=xxx&format=xlsx" \
  --cookie "token=your-token" \
  -o performance.xlsx

# å¯¼å‡ºé”™è¯¯æ•°æ®
curl "http://localhost:3000/api/export/errors?appId=xxx&type=all&format=csv" \
  --cookie "token=your-token" \
  -o errors.csv
```

### æµ‹è¯•å‘Šè­¦

```bash
# æ‰‹åŠ¨è§¦å‘å‘Šè­¦æ£€æŸ¥
curl -X POST http://localhost:3000/api/alert/check \
  -H "Content-Type: application/json" \
  -H "Cookie: token=your-token" \
  -d '{"appId":"xxx"}'
```

---

## ğŸ“– æ–‡æ¡£

- **åŠŸèƒ½å®Œæˆæ¸…å•ï¼š** [FEATURE_COMPLETE.md](./FEATURE_COMPLETE.md)
- **åŠŸèƒ½å¯¹æ¯”è¯¦æƒ…ï¼š** [FEATURE_COMPARISON.md](./FEATURE_COMPARISON.md)
- **é«˜çº§åŠŸèƒ½æ‰©å±•ï¼š** [ADVANCED_FEATURES_GUIDE.md](./ADVANCED_FEATURES_GUIDE.md)
- **SDK é›†æˆæŒ‡å—ï¼š** [SDK_INTEGRATION_GUIDE.md](./SDK_INTEGRATION_GUIDE.md)
- **éƒ¨ç½²æŒ‡å—ï¼š** [DEPLOYMENT.md](./DEPLOYMENT.md)
- **ç”¨æˆ·æŒ‡å—ï¼š** [USER_GUIDE.md](./USER_GUIDE.md)

---

## ğŸš€ éƒ¨ç½²

### å¼€å‘ç¯å¢ƒ

```bash
pnpm dev
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# 1. æ„å»º
pnpm build

# 2. å¯åŠ¨
pnpm start

# æˆ–ä½¿ç”¨ PM2
pm2 start npm --name "frontend-monitor" -- start
```

### Docker éƒ¨ç½²

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package.json pnpm-lock.yaml ./
RUN npm install -g pnpm && pnpm install --frozen-lockfile

COPY . .
RUN pnpm build

EXPOSE 3000

CMD ["pnpm", "start"]
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ Redis ç¼“å­˜é«˜é¢‘æŸ¥è¯¢
- åˆç†è®¾ç½® Elasticsearch ç´¢å¼•
- å®šæœŸæ¸…ç†å†å²æ•°æ®

### 2. å®‰å…¨å»ºè®®
- ç”Ÿäº§ç¯å¢ƒä¿®æ”¹ JWT_SECRET
- é…ç½® CORS ç™½åå•
- é™åˆ¶ API è®¿é—®é¢‘ç‡

### 3. ç›‘æ§å»ºè®®
- é…ç½®å‘Šè­¦é€šçŸ¥æ¸ é“
- è®¾ç½®å®šæ—¶ä»»åŠ¡æ£€æŸ¥
- ç›‘æ§ Elasticsearch æ€§èƒ½

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2026-01-16)

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… å®Œæ•´çš„æ•°æ®é‡‡é›†å’Œå­˜å‚¨
- âœ… 7 å¤§åˆ†ææ¨¡å—
- âœ… SourceMap å®Œæ•´æ”¯æŒ
- âœ… Redis ç¼“å­˜å±‚
- âœ… æ•°æ®å¯¼å‡ºåŠŸèƒ½
- âœ… å‘Šè­¦ç³»ç»Ÿæ¡†æ¶

**æŠ€æœ¯æ ˆï¼š**
- Next.js 16
- React 19
- TypeScript
- Prisma 5
- Ant Design 5

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

## ğŸ“„ è®¸å¯

MIT License

---

## ğŸ‘¥ å›¢é˜Ÿ

å¼€å‘å›¢é˜Ÿï¼šFrontend Watch Dog Team

---

## ğŸ‰ æ€»ç»“

**Next.js ç‰ˆæœ¬å·² 100% å®Œæˆæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼**

ç›¸æ¯”åŸé¡¹ç›®ï¼š
- âœ… åŠŸèƒ½æ›´å®Œæ•´
- âœ… æŠ€æœ¯æ›´ç°ä»£
- âœ… æ€§èƒ½æ›´ä¼˜ç§€
- âœ… ç»´æŠ¤æ›´ç®€å•

**ç°åœ¨å¯ä»¥å®Œå…¨æ›¿ä»£åŸé¡¹ç›®æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ï¼** ğŸš€
